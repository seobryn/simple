cmake_minimum_required(VERSION 3.0.0)

set(CMAKE_BUILD_TYPE "Debug" CACHE STRING
    "Choose the type of build, options are: Debug Release RelWithDebInfo." FORCE)

# Export compilation database in JSON format.
set(CMAKE_EXPORT_COMPILE_COMMANDS on)

project(simple CXX)
set(CMAKE_MODULE_PATH ${CMAKE_SOURCE_DIR}/cmake ${CMAKE_MODULE_PATH})

set(SIMPLE_VERSION_MAJOR 0)
set(SIMPLE_VERSION_MINOR 1)
set(SIMPLE_VERSION_PATCH 0)
set(SIMPLE_VERSION_STR "${SIMPLE_VERSION_MAJOR}.${SIMPLE_VERSION_MINOR}.${SIMPLE_VERSION_PATCH}")

message("Configuring simple v${SIMPLE_VERSION_STR}")

include_directories(
    ${CMAKE_SOURCE_DIR}
    ${CMAKE_BINARY_DIR}
)

set(SIMPLE_SOURCES
    "${CMAKE_SOURCE_DIR}/src/main.cpp"
    "${CMAKE_SOURCE_DIR}/src/lexer.cpp"
    "${CMAKE_SOURCE_DIR}/src/parser.cpp"
)
set(CONFIGURE_OUT_FILE "${CMAKE_BINARY_DIR}/config.h")
configure_file (
    "${CMAKE_SOURCE_DIR}/src/config.h.in"
    ${CONFIGURE_OUT_FILE}
)

set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wall -Wextra -std=c++20")

add_executable(
    simple 
    ${SIMPLE_SOURCES}
)
set_target_properties(simple PROPERTIES
    LINKER_LANGUAGE CXX
)
install(TARGETS simple DESTINATION bin)
